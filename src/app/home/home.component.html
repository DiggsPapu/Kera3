<!--HEADER-->
<header id="top-head" class="uk-position-fixed">
    <div class="uk-container uk-container-expand uk-background-third">
        <nav class="uk-navbar uk-light" data-uk-navbar="mode:click; duration: 250">
            <div class="uk-navbar-right">
                <ul class="uk-navbar-nav">
                    <li><a class="uk-navbar-toggle uk-hidden@m" data-uk-toggle data-uk-navbar-toggle-icon
                            href="#offcanvas-nav" title="Offcanvas" data-uk-tooltip></a></li>
                </ul>
            </div>
        </nav>
    </div>
</header>
<!--/HEADER-->
<!-- LEFT BAR -->
<aside id="left-col" class="uk-light uk-visible@m uk-back-third">
    <div class="left-content-box  content-box-dark">
        <h4 class="uk-text-center uk-margin-remove-vertical text-light">{{userData.user_nombres}} {{userData.user_apellidos}}</h4>
        <div class="uk-position-relative uk-text-center uk-display-block">
            <p class="uk-text-small uk-text-muted uk-display-block uk-text-center">{{userData.rol_interno.toUpperCase()}}</p>
        </div>
    </div>
    <div class="left-nav-wrap">
        <div class="left-content-box uk-margin-top">
          <h5 class="nav-option {{ navcurrent === 'inv' ? 'active' : '' }}" (click)="setCurrentNav('inv')">Inventario</h5>
          <h5 class="nav-option {{ navcurrent === 'desp' ? 'active' : '' }}" (click)="setCurrentNav('desp')">Despachos</h5>
          <h5 class="nav-option {{ navcurrent === 'inst' ? 'active' : '' }}" (click)="setCurrentNav('inst')">Instalaciones</h5>
          <h5 class="nav-option {{ navcurrent === 'sale' ? 'active' : '' }}" (click)="setCurrentNav('sales')">Ventas</h5>
          <h5 class="nav-option {{ navcurrent === 'buys' ? 'active' : '' }}" (click)="setCurrentNav('buys')">Compras</h5>
          <h5 class="nav-option {{ navcurrent === 'cli' ? 'active' : '' }}" (click)="setCurrentNav('cli')">Clientes</h5>
          <h5 class="nav-option {{ navcurrent === 'hr' ? 'active' : '' }}" (click)="setCurrentNav('hr')" *ngIf="userData.rol_interno == 'ADMINISTRADOR'" >Empleados</h5>
        </div>
    </div>
    <div class="bar-bottom uk-back-black">
        <ul class="uk-subnav uk-flex uk-flex-center uk-child-width-1-5" data-uk-grid>
            <li>
                <a class="uk-icon-link" data-uk-icon="icon: sign-out" data-uk-tooltip="Salir" (click)="logOut()"></a>
            </li>
        </ul>
    </div>
</aside>
<!-- /LEFT BAR -->
<!-- CONTENT -->
<div id="content" data-uk-height-viewport="expand: true">
  <!-- inventory panel -->
    <div class="uk-container uk-container-expand" *ngIf="navcurrent == 'inv'">
        <div class="uk-grid-divider uk-grid-medium uk-child-width-1-1 uk-child-width-1-2@s" data-uk-grid>
            <div>
                <div class="uk-child-width-1-2" uk-grid>
                    <div>
                        <h1 class="uk-heading-primary uk-margin-remove  uk-text-third">Inventario</h1>
                    </div>
                </div>
            </div>
            <div>
                <button class="add-product uk-button uk-align-left uk-button-primary" (click)="insertingProduct()"><span uk-icon="icon: plus"></span> Agregar producto</button>
            </div>
        </div>
        <hr>
        <div class="uk-grid uk-grid-medium" data-uk-grid uk-sortable="handle: .sortable-icon">

            <!-- panel -->
            <div class="uk-width-1-1">
                <div class="uk-card uk-card-default uk-card-small uk-card-hover">
                    <div class="uk-card-header">
                        <div class="uk-grid uk-grid-small ">
                            <div class="uk-width-expand uk-width-1-4">
                                <div class="uk-margin">
                                    <form class="uk-search uk-width-expand uk-search-default">
                                        <span uk-search-icon></span>
                                        <input class="uk-search-input" type="search" placeholder="Búsqueda" aria-label="Search" [(ngModel)]="searchQuery" (input)="onSearch()" [ngModelOptions]="{standalone: true}">
                                    </form>
                                </div>
                            </div>
                            <div class="uk-width-expand uk-width-1-4">
                                <div class="display--filters">
                                    <label for="" style="margin-right: 5%;">Categoría:</label>
                                    <select class="uk-select" [(ngModel)]="categoriaValue">
                                        <option value="all">Todos</option>
                                        <option *ngFor="let categoria of categorias"
                                            [value]="categoria.codigo_categoria">{{ categoria.nombre_categoria }}
                                        </option>
                                    </select>
                                </div>
                            </div>
                            <div class="uk-width-expand uk-width-1-4">
                                <div class="display--filters">
                                    <label for="" style="margin-right: 5%;">Estado:</label>
                                    <select class="uk-select" [(ngModel)]="estadoValue">
                                        <option value="0">Todos</option>
                                        <option *ngFor="let estado of estados" [value]="estado.codigo_estado">{{
                                            estado.nombre_estado }}</option>
                                    </select>
                                </div>
                            </div>
                            <div class="uk-width-expand uk-width-1-4">
                                <div class="display--filters">
                                    <label for="" style="margin-right: 5%;">Instalación:</label>
                                    <select class="uk-select" [(ngModel)]="instalacionValue">
                                        <option value="all">Todos</option>
                                        <option *ngFor="let instalacion of instalaciones" [value]="instalacion.codigo_instalacion">{{
                                          instalacion.nombre_instalacion }}</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="uk-card-body">
                        <div class="chart-container uk-overflow-auto">
                            <table class="uk-table uk-table-small uk-table-striped uk-table-responsive">
                                <thead>
                                    <tr>
                                        <th class="uk-table-small">Código</th>
                                        <th class="uk-table-large">Nombre</th>
                                        <th class="uk-table-expand">Categoría</th>
                                        <th class="uk-table-small">Dimensional</th>
                                        <th class="uk-table-small">Disponible</th>
                                        <th class="uk-table-expand">Estado</th>
                                        <th class="uk-table-expand">Ubicación</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <ng-container *ngFor="let product of data">
                                        <tr  (click)="getDetails(product)" *ngIf="(categoriaValue === product.codigo_categoria || categoriaValue === 'all')
                                        && (estadoValue == product.codigo_estado || estadoValue === '0')
                                        && (product.codigo_instalacion == instalacionValue || instalacionValue == 'all')
                                        ">
                                          <td>{{ product.codigo_producto }}</td>
                                          <td>{{ product.nombre_producto }}</td>
                                          <td>{{ product.nombre_categoria }}</td>
                                          <td>{{ product.codigo_dimensional }}</td>
                                          <td>{{ product.cantidad}}</td>
                                          <td class={{product.nombre_estado}}>{{ product.nombre_estado }}</td>
                                          <td>{{product.codigo_instalacion}}</td>
                                        </tr>
                                    </ng-container>
                                </tbody>
                            </table>
                            <ng-template #empty>
                                <h3>Datos no encontrados, por favor verifica tus filtros.</h3>
                            </ng-template>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /panel -->
        </div>
        <ul class="uk-pagination pagination--position center-flex" uk-margin>
          <button type="button" class="btn-pagination " [disabled]="currentPage===1" (click)="returnFirstPage()" >Inicio</button>
          <button type="button" class="btn-pagination " [disabled]="currentPage === 1" (click)="prevPage()">Anterior</button>
          <span class="pagination-indicator">{{ currentPage }} / {{ totalPages }}</span>
          <button type="button" class="btn-pagination" [disabled]="currentPage === totalPages" (click)="nextPage()">Siguiente</button>
          <button type="button" class="btn-pagination" [disabled]="currentPage === totalPages" (click)="returnLastPage()">Final</button>
        </ul>
        <footer class="uk-section uk-section-small uk-text-center">
            <hr>
            <span class="uk-text-small uk-text-muted">© 2023 <a class="uk-text-third"
                    href="https://www.facebook.com/profile.php?id=100054286971522">Kera3</a> | Proyecto Ingenieria de
                Software</span>
        </footer>
    </div>
    <!-- dispatch pannel -->
    <app-dispatch *ngIf="navcurrent == 'desp'" ></app-dispatch>
    <!-- Instalaciones panel -->
    <app-instalaciones *ngIf="navcurrent == 'inst'"></app-instalaciones>
    <!-- clients panel -->
    <app-clients *ngIf="navcurrent == 'cli'"></app-clients>
    <!-- panel de ventas -->
    <app-ventas [instalation] = "this.userData.codigo_instalacion" [user_id]="this.userData.user_id" *ngIf="navcurrent == 'sales'"></app-ventas>
    <!-- panel de compras -->
    <app-compras [instalation] = "this.userData.codigo_instalacion" [user_id]="this.userData.user_id" *ngIf="navcurrent == 'buys'"></app-compras>
    <!-- employees panel -->
    <app-employees *ngIf="navcurrent == 'hr' && userData.rol_interno == 'ADMINISTRADOR'"></app-employees>

</div>
<!-- /CONTENT -->
<!-- OFFCANVAS -->
<div id="offcanvas-nav" data-uk-offcanvas="flip: true; overlay: true">
    <div class="uk-offcanvas-bar uk-offcanvas-bar-animation uk-offcanvas-slide uk-back-third">
        <button class="uk-offcanvas-close uk-close uk-icon" type="button" data-uk-close></button>
        <ul class="uk-nav uk-nav-default uk-position-center">
          <h5 class="nav-option {{ navcurrent === 'inv' ? 'active' : '' }}" (click)="setCurrentNav('inv')">Inventario</h5>
          <h5 class="nav-option {{ navcurrent === 'desp' ? 'active' : '' }}" (click)="setCurrentNav('desp')">Despachos</h5>
          <h5 class="nav-option {{ navcurrent === 'inst' ? 'active' : '' }}" (click)="setCurrentNav('inst')">Instalaciones</h5>
          <h5 class="nav-option {{ navcurrent === 'sale' ? 'active' : '' }}" (click)="setCurrentNav('sales')">Ventas</h5>
          <h5 class="nav-option {{ navcurrent === 'buys' ? 'active' : '' }}" (click)="setCurrentNav('buys')">Compras</h5>
          <h5 class="nav-option {{ navcurrent === 'cli' ? 'active' : '' }}" (click)="setCurrentNav('cli')">Clientes</h5>
          <h5 class="nav-option {{ navcurrent === 'hr' ? 'active' : '' }}" (click)="setCurrentNav('hr')" *ngIf="userData.rol_interno == 'ADMINISTRADOR'">Empleados</h5>
            <li class="uk-nav-header">Opciones</li>
            <li><a href="/login"><span class="uk-margin-small-right uk-icon" data-uk-icon="icon: sign-out" (click)="logOut()"></span>
                    Salir</a></li>
        </ul>
    </div>
</div>
<!-- /OFFCANVAS -->
